import{_ as e,E as t,T as a,U as o,D as s,S as n,K as l,o as i,c as r,w as m,i as d,a as u,d as c,f,g as p,H as h,an as b}from"./index.1c5e976d.js";import{_ as D}from"./uni-easyinput.2a636516.js";import{_}from"./uni-forms-item.0adb67f4.js";import{_ as g}from"./uni-forms.1f46fdd1.js";import{v as y}from"./uni-cms-categories.9d38cea1.js";const V=t.database();V.command;const j="uni-cms-categories";function k(e){let t={};for(let a in y)e.includes(a)&&(t[a]=y[a]);return t}const v=e({data(){let e={name:"",description:"",icon:"",sort:null,create_date:null};return{formData:e,formOptions:{},rules:{...k(Object.keys(e))}}},onLoad(e){if(e.id){const t=e.id;this.formDataId=t,this.getDetail(t)}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){a({mask:!0}),this.$refs.form.validate().then((e=>this.submitForm(e))).catch((()=>{})).finally((()=>{o()}))},submitForm(e){return V.collection(j).doc(this.formDataId).update(e).then((e=>{s({title:"修改成功"});try{this.getOpenerEventChannel().emit("refreshData")}catch(t){}setTimeout((()=>n()),500)})).catch((e=>{l({content:e.message||"请求服务失败",showCancel:!1})}))},getDetail(e){a({mask:!0}),V.collection(j).doc(e).field("name,description,icon,sort,create_date").get().then((e=>{const t=e.result.data[0];t&&(this.formData=t)})).catch((e=>{l({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{o()}))}}},[["render",function(e,t,a,o,s,n){const l=f(p("uni-easyinput"),D),y=f(p("uni-forms-item"),_),V=h,j=b,k=d,v=f(p("uni-forms"),g);return i(),r(k,{class:"uni-container"},{default:m((()=>[u(v,{ref:"form",model:s.formData,validateTrigger:"bind"},{default:m((()=>[u(y,{name:"name",label:"名称",required:""},{default:m((()=>[u(l,{placeholder:"类别名称",modelValue:s.formData.name,"onUpdate:modelValue":t[0]||(t[0]=e=>s.formData.name=e),trim:"both"},null,8,["modelValue"])])),_:1}),u(y,{name:"description",label:"描述"},{default:m((()=>[u(l,{placeholder:"类别描述",modelValue:s.formData.description,"onUpdate:modelValue":t[1]||(t[1]=e=>s.formData.description=e),trim:"both"},null,8,["modelValue"])])),_:1}),u(y,{name:"sort",label:"排序"},{default:m((()=>[u(l,{placeholder:"类别显示顺序",type:"number",modelValue:s.formData.sort,"onUpdate:modelValue":t[2]||(t[2]=e=>s.formData.sort=e)},null,8,["modelValue"])])),_:1}),u(k,{class:"uni-button-group"},{default:m((()=>[u(V,{type:"primary",class:"uni-button",style:{width:"100px"},onClick:n.submit},{default:m((()=>[c("提交")])),_:1},8,["onClick"]),u(j,{"open-type":"navigateBack",style:{"margin-left":"15px"}},{default:m((()=>[u(V,{class:"uni-button",style:{width:"100px"}},{default:m((()=>[c("返回")])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})}]]);export{v as default};
