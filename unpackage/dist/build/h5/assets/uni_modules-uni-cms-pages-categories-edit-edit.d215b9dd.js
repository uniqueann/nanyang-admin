import{_ as e,D as t,J as a,K as s,s as o,A as n,y as l,o as i,c as r,w as m,i as u,a as d,d as c,f,g as p,q as h,S as b}from"./index-52dd6894.js";import{_ as g}from"./uni-easyinput.cff98e18.js";import{_ as y}from"./uni-forms-item.4e6b57d7.js";import{_ as D}from"./uni-forms.9d63b157.js";import{v as _}from"./uni-cms-categories.e2a14b3e.js";const V=t.database();V.command;function j(e){let t={};for(let a in _)e.includes(a)&&(t[a]=_[a]);return t}const k=e({data(){let e={name:"",description:"",icon:"",sort:null,create_date:null};return{formData:e,formOptions:{},rules:{...j(Object.keys(e))}}},onLoad(e){if(e.id){const t=e.id;this.formDataId=t,this.getDetail(t)}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){a({mask:!0}),this.$refs.form.validate().then((e=>this.submitForm(e))).catch((()=>{})).finally((()=>{s()}))},submitForm(e){return V.collection("uni-cms-categories").doc(this.formDataId).update(e).then((e=>{o({title:"修改成功"});try{this.getOpenerEventChannel().emit("refreshData")}catch(t){}setTimeout((()=>n()),500)})).catch((e=>{l({content:e.message||"请求服务失败",showCancel:!1})}))},getDetail(e){a({mask:!0}),V.collection("uni-cms-categories").doc(e).field("name,description,icon,sort,create_date").get().then((e=>{const t=e.result.data[0];t&&(this.formData=t)})).catch((e=>{l({content:e.message||"请求服务失败",showCancel:!1})})).finally((()=>{s()}))}}},[["render",function(e,t,a,s,o,n){const l=f(p("uni-easyinput"),g),_=f(p("uni-forms-item"),y),V=h,j=b,k=u,v=f(p("uni-forms"),D);return i(),r(k,{class:"uni-container"},{default:m((()=>[d(v,{ref:"form",model:o.formData,validateTrigger:"bind"},{default:m((()=>[d(_,{name:"name",label:"名称",required:""},{default:m((()=>[d(l,{placeholder:"类别名称",modelValue:o.formData.name,"onUpdate:modelValue":t[0]||(t[0]=e=>o.formData.name=e),trim:"both"},null,8,["modelValue"])])),_:1}),d(_,{name:"description",label:"描述"},{default:m((()=>[d(l,{placeholder:"类别描述",modelValue:o.formData.description,"onUpdate:modelValue":t[1]||(t[1]=e=>o.formData.description=e),trim:"both"},null,8,["modelValue"])])),_:1}),d(_,{name:"sort",label:"排序"},{default:m((()=>[d(l,{placeholder:"类别显示顺序",type:"number",modelValue:o.formData.sort,"onUpdate:modelValue":t[2]||(t[2]=e=>o.formData.sort=e)},null,8,["modelValue"])])),_:1}),d(k,{class:"uni-button-group"},{default:m((()=>[d(V,{type:"primary",class:"uni-button",style:{width:"100px"},onClick:n.submit},{default:m((()=>[c("提交")])),_:1},8,["onClick"]),d(j,{"open-type":"navigateBack",style:{"margin-left":"15px"}},{default:m((()=>[d(V,{class:"uni-button",style:{width:"100px"}},{default:m((()=>[c("返回")])),_:1})])),_:1})])),_:1})])),_:1},8,["model"])])),_:1})}]]);export{k as default};
