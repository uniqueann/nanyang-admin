import{_ as e,a3 as t,o as n,c as a,w as r,a as s,q as o,z as i,s as l,a4 as u,b as c,i as p,e as d,r as h,F as m,d as g,t as f,u as _,am as y,aF as w,E as b,aG as C,n as S,f as M,g as k,H as E,a2 as P,C as x,aC as v,y as L,h as T,j as O,k as A,l as D,O as R}from"./index.96d04c0c.js";import{_ as U}from"./uni-stat-breadcrumb.532397ab.js";import{_ as F}from"./uni-data-select.77e53882.js";import{_ as $}from"./uni-stat-tabs.66b03f23.js";import{_ as I}from"./uni-stat-panel.0d2930ae.js";import{_ as N}from"./qiun-data-charts.36b855f8.js";import{_ as q}from"./uni-tooltip.2bdb2fa0.js";import{_ as z}from"./uni-pagination.1c4c12cb.js";import{_ as B}from"./uni-load-more.b58ece14.js";import{i as j,s as G,d as V,g as W,j as Q,h as H,p as J,m as X,k as K}from"./util.9a87b1b0.js";import{f as Y,p as Z}from"./fieldsMap.f0afc8f5.js";const ee=e({name:"UniDrawer",components:{keypress:{name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted(){const e={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(t=>{if(this.disable)return;const n=Object.keys(e).find((n=>{const a=t.key,r=e[n];return r===a||Array.isArray(r)&&r.includes(a)}));n&&setTimeout((()=>{this.$emit(n,{})}),0)}))},render:()=>{}}},emits:["change"],props:{mode:{type:String,default:""},mask:{type:Boolean,default:!0},maskClick:{type:Boolean,default:!0},width:{type:Number,default:220}},data:()=>({visibleSync:!1,showDrawer:!1,rightMode:!1,watchTimer:null,drawerWidth:220}),created(){this.drawerWidth=this.width,this.rightMode="right"===this.mode},methods:{clear(){},close(e){("mask"!==e||this.maskClick)&&this.visibleSync&&this._change("showDrawer","visibleSync",!1)},open(){this.visibleSync||this._change("visibleSync","showDrawer",!0)},_change(e,t,n){this[e]=n,this.watchTimer&&clearTimeout(this.watchTimer),this.watchTimer=setTimeout((()=>{this[t]=n,this.$emit("change",n)}),n?50:300)}}},[["render",function(e,d,h,m,g,f){const _=p,y=t("keypress");return g.visibleSync?(n(),a(_,{key:0,class:o([{"uni-drawer--visible":g.showDrawer},"uni-drawer"]),onTouchmove:u(f.clear,["stop","prevent"])},{default:r((()=>[s(_,{class:o(["uni-drawer__mask",{"uni-drawer__mask--visible":g.showDrawer&&h.mask}]),onClick:d[0]||(d[0]=e=>f.close("mask"))},null,8,["class"]),s(_,{class:o(["uni-drawer__content",{"uni-drawer--right":g.rightMode,"uni-drawer--left":!g.rightMode,"uni-drawer__content--visible":g.showDrawer}]),style:i({width:g.drawerWidth+"px"})},{default:r((()=>[l(e.$slots,"default",{},void 0,!0)])),_:3},8,["class","style"]),s(y,{onEsc:d[1]||(d[1]=e=>f.close("mask"))})])),_:3},8,["class","onTouchmove"])):c("",!0)}],["__scopeId","data-v-ac0dbaaa"]]);const te=e({props:{uploadTasks:{type:Array,default:function(){return[]}},showProgress:{type:Boolean,default:!0}}},[["render",function(e,t,o,i,l,u){const w=_,b=y,C=p;return n(),a(C,null,{default:r((()=>[(n(!0),d(m,null,h(o.uploadTasks,((e,t)=>(n(),a(C,{key:t,class:"upload-task-body"},{default:r((()=>[s(C,{class:"upload-task-item"},{default:r((()=>[s(w,{class:"upload-task-item-name"},{default:r((()=>[g(f(e.name),1)])),_:2},1024),o.showProgress?(n(),a(b,{key:0,class:"upload-task-item-progress",activeColor:-1!==e.state?"#42b983":"#ff5a5f",percent:100*e.progress,active:"",duration:5},null,8,["activeColor","percent"])):c("",!0),s(C,{class:"flex",style:{"justify-content":"space-between"}},{default:r((()=>[s(w,{class:"upload-task-item-size"},{default:r((()=>[g(f(e.size),1)])),_:2},1024),s(w,{class:"upload-task-item-size"},{default:r((()=>[g(f(-1!==e.state?"":"失败"),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})}],["__scopeId","data-v-5938fce7"]]),ne={},ae=Object,re="undefined"!=typeof window&&window.window===window&&window.navigator,se=re?null:module.require,oe=e=>e[e.length-1],ie=e=>e.replace(/\\/g,"/"),le=re?window.location.href:ie(process.cwd())+"/";class ue{constructor(e,t,n){this.itemsHeader=[],this.isMP=!1;const a=e,r=e&&e instanceof SyntaxError&&!re;if(e||(e=new Error,n=void 0===n?1:n),e instanceof Error&&(e=e.stack||""),"string"==typeof e&&(this.isMP="mp-weixin"===t,e=this.rawParse(e).slice(n).map((e=>this.extractEntryMetadata(e)))),Array.isArray(e)){if(r){const t=se("util").inspect(a).split("\n"),n=t[0].split(":"),r=n.pop(),s=n.join(":");s&&e.unshift({file:ie(s),line:r,column:(t[2]||"").indexOf("^")+1,sourceLine:t[1],callee:"(syntax error)",syntaxError:!0})}this.items=e}else this.items=[]}extractEntryMetadata(e){const t=this.decomposePath(e.file||""),n=t[0],a=t[1];return ae.assign(e,{calleeShort:e.calleeShort||oe((e.callee||"").split(".")),fileRelative:n,fileShort:this.shortenPath(n),fileName:oe((e.file||"").split("/")),thirdParty:this.isThirdParty(n,a)&&!e.index,externalDomain:a})}shortenPath(e){return e.replace(/^node_modules\//,"").replace(/^webpack\/bootstrap\//,"").replace(/^__parcel_source_root\//,"")}decomposePath(e){let t=e;re&&(t=t.replace(le,""));const n=t.match(/^(http|https)\:\/\/?([^\/]+)\/{1,}(.*)/),a=n?n[2]:void 0;return t=n?n[3]:t,[ie(t).replace(/^.*\:\/\/?\/?/,""),a]}isThirdParty(e,t){return this.isMP?void 0!==t&&"usr"!==t:"~"===e[0]||"/"===e[0]||-1!==e.indexOf("@dcloudio")||-1!==e.indexOf("weex-main-jsfm")||0===e.indexOf("webpack/bootstrap")}rawParse(e){return(e||"").split("\n").map(((e,t)=>{let n,a,r,s,o=[];if(-1!==(e=e.trim()).indexOf("file:")&&(e=e.replace(/file:\/\/(.*)www/,"file://")),(r=e.match(/at (.+) \(eval at .+ \((.+)\), .+\)/))||(r=e.match(/at (.+) \((.+)\)/))||"at "!==e.slice(0,3)&&(r=e.match(/(.*)@(.*)/)))this.itemsHeader.push("%StacktraceyItem%"),n=r[1],a="native"===r[2],o=(r[2].match(/(.*):(\d+):(\d+)/)||r[2].match(/(.*):(\d+)/)||r[2].match(/\[(.*)\]/)||[]).slice(1);else{if(!(s=e.match(/^(at\s*)*(.*)\s+(.+):(\d+):(\d+)/)))return void this.itemsHeader.push(e);this.itemsHeader.push("%StacktraceyItem%"),n=s[2].trim(),o=s.slice(3)}if(n&&!o[0]){"Array"===n.split(".")[0]&&(a=!0)}return{beforeParse:e,callee:n||"",index:re&&o[0]===window.location.href,native:a||!1,file:ie(o[0]||""),line:parseInt(o[1]||"",10)||void 0,column:parseInt(o[2]||"",10)||void 0}})).filter((e=>void 0!==e))}maxColumnWidths(){return{callee:30,file:60,sourceLine:80}}asTable(e){const t=e&&e.maxColumnWidths||this.maxColumnWidths(),n=this.filter((e=>!e.thirdParty)).map((e=>pe(e,t,this.isMP))),a=this.filter((e=>e.thirdParty)).map((e=>pe(e,t,this.isMP)));return{items:n.items,thirdPartyItems:a.items}}}const ce=(e,t)=>e&&(e.length>t?e.slice(0,t-1)+"…":e);function pe(e,t,n){if(!e.parsed)return e.beforeParse;const a=(n?e.file&&e.file:e.fileShort&&e.fileShort)+`${e.line?":"+e.line:""}${e.column?":"+e.column:""}`;return["at "+ce(n?e.callee:e.calleeShort,t.callee),(r=a||"",s=t.file,r&&(r.length>s?"…"+r.slice(-(s-1)):r)),ce((e.sourceLine||"").trim()||"",t.sourceLine)];var r,s}["map","filter","slice","concat"].forEach((e=>{ue.prototype[e]=function(){return new ue(this.items[e].apply(this.items,arguments))}}));var de=ue;function he(e){var t={exports:{}};return e(t,t.exports),t.exports}var me=he((function(e,t){t.getArg=function(e,t,n){if(t in e)return e[t];if(3===arguments.length)return n;throw new Error('"'+t+'" is a required argument.')};const n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,a=/^data:.+\,.+$/;function r(e){const t=e.match(n);return t?{scheme:t[1],auth:t[2],host:t[3],port:t[4],path:t[5]}:null}function s(e){let t="";return e.scheme&&(t+=e.scheme+":"),t+="//",e.auth&&(t+=e.auth+"@"),e.host&&(t+=e.host),e.port&&(t+=":"+e.port),e.path&&(t+=e.path),t}t.urlParse=r,t.urlGenerate=s;const o=function(e){const t=[];return function(n){for(let e=0;e<t.length;e++)if(t[e].input===n){const n=t[0];return t[0]=t[e],t[e]=n,t[0].result}const a=e(n);return t.unshift({input:n,result:a}),t.length>32&&t.pop(),a}}((function(e){let n=e;const a=r(e);if(a){if(!a.path)return e;n=a.path}const o=t.isAbsolute(n),i=[];let l=0,u=0;for(;;){if(l=u,u=n.indexOf("/",l),-1===u){i.push(n.slice(l));break}for(i.push(n.slice(l,u));u<n.length&&"/"===n[u];)u++}let c=0;for(u=i.length-1;u>=0;u--){const e=i[u];"."===e?i.splice(u,1):".."===e?c++:c>0&&(""===e?(i.splice(u+1,c),c=0):(i.splice(u,2),c--))}return n=i.join("/"),""===n&&(n=o?"/":"."),a?(a.path=n,s(a)):n}));function i(e,t){""===e&&(e="."),""===t&&(t=".");const n=r(t),i=r(e);if(i&&(e=i.path||"/"),n&&!n.scheme)return i&&(n.scheme=i.scheme),s(n);if(n||t.match(a))return t;if(i&&!i.host&&!i.path)return i.host=t,s(i);const l="/"===t.charAt(0)?t:o(e.replace(/\/+$/,"")+"/"+t);return i?(i.path=l,s(i)):l}t.normalize=o,t.join=i,t.isAbsolute=function(e){return"/"===e.charAt(0)||n.test(e)},t.relative=function(e,t){""===e&&(e="."),e=e.replace(/\/$/,"");let n=0;for(;0!==t.indexOf(e+"/");){const a=e.lastIndexOf("/");if(a<0)return t;if((e=e.slice(0,a)).match(/^([^\/]+:\/)?\/*$/))return t;++n}return Array(n+1).join("../")+t.substr(e.length+1)};const l=!("__proto__"in Object.create(null));function u(e){return e}function c(e){if(!e)return!1;const t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(let n=t-10;n>=0;n--)if(36!==e.charCodeAt(n))return!1;return!0}function p(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}t.toSetString=l?u:function(e){return c(e)?"$"+e:e},t.fromSetString=l?u:function(e){return c(e)?e.slice(1):e},t.compareByOriginalPositions=function(e,t,n){let a=p(e.source,t.source);return 0!==a?a:(a=e.originalLine-t.originalLine,0!==a?a:(a=e.originalColumn-t.originalColumn,0!==a||n?a:(a=e.generatedColumn-t.generatedColumn,0!==a?a:(a=e.generatedLine-t.generatedLine,0!==a?a:p(e.name,t.name)))))},t.compareByGeneratedPositionsDeflated=function(e,t,n){let a=e.generatedLine-t.generatedLine;return 0!==a?a:(a=e.generatedColumn-t.generatedColumn,0!==a||n?a:(a=p(e.source,t.source),0!==a?a:(a=e.originalLine-t.originalLine,0!==a?a:(a=e.originalColumn-t.originalColumn,0!==a?a:p(e.name,t.name)))))},t.compareByGeneratedPositionsInflated=function(e,t){let n=e.generatedLine-t.generatedLine;return 0!==n?n:(n=e.generatedColumn-t.generatedColumn,0!==n?n:(n=p(e.source,t.source),0!==n?n:(n=e.originalLine-t.originalLine,0!==n?n:(n=e.originalColumn-t.originalColumn,0!==n?n:p(e.name,t.name)))))},t.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))},t.computeSourceURL=function(e,t,n){if(t=t||"",e&&("/"!==e[e.length-1]&&"/"!==t[0]&&(e+="/"),t=e+t),n){const e=r(n);if(!e)throw new Error("sourceMapURL could not be parsed");if(e.path){const t=e.path.lastIndexOf("/");t>=0&&(e.path=e.path.substring(0,t+1))}t=i(s(e),t)}return o(t)}}));class ge{constructor(){this._array=[],this._set=new Map}static fromArray(e,t){const n=new ge;for(let a=0,r=e.length;a<r;a++)n.add(e[a],t);return n}size(){return this._set.size}add(e,t){const n=this.has(e),a=this._array.length;n&&!t||this._array.push(e),n||this._set.set(e,a)}has(e){return this._set.has(e)}indexOf(e){const t=this._set.get(e);if(t>=0)return t;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}var fe=me,_e={ArraySet:ge},ye=he((function(e,t){function n(e,a,r,s,o,i){const l=Math.floor((a-e)/2)+e,u=o(r,s[l],!0);return 0===u?l:u>0?a-l>1?n(l,a,r,s,o,i):i==t.LEAST_UPPER_BOUND?a<s.length?a:-1:l:l-e>1?n(e,l,r,s,o,i):i==t.LEAST_UPPER_BOUND?l:e<0?-1:e}t.GREATEST_LOWER_BOUND=1,t.LEAST_UPPER_BOUND=2,t.search=function(e,a,r,s){if(0===a.length)return-1;let o=n(-1,a.length,e,a,r,s||t.GREATEST_LOWER_BOUND);if(o<0)return-1;for(;o-1>=0&&0===r(a[o],a[o-1],!0);)--o;return o}})),we=he((function(e){{let t=null;e.exports=function(){if("string"==typeof t)return fetch(t).then((e=>e.arrayBuffer()));if(t instanceof ArrayBuffer)return Promise.resolve(t);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},e.exports.initialize=e=>t=e}}));function be(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let Ce=null;var Se=ye,Me=function(){if(Ce)return Ce;const e=[];return Ce=we().then((t=>WebAssembly.instantiate(t,{env:{mapping_callback(t,n,a,r,s,o,i,l,u,c){const p=new be;p.generatedLine=t+1,p.generatedColumn=n,a&&(p.lastGeneratedColumn=r-1),s&&(p.source=o,p.originalLine=i+1,p.originalColumn=l,u&&(p.name=c)),e[e.length-1](p)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}}))).then((t=>({exports:t.instance.exports,withMappingCallback:(t,n)=>{e.push(t);try{n()}finally{e.pop()}}}))).then(null,(e=>{throw Ce=null,e})),Ce};const ke=_e.ArraySet,Ee=Symbol("smcInternal");class Pe{constructor(e,t){return e==Ee?Promise.resolve(this):function(e,t){let n=e;"string"==typeof e&&(n=fe.parseSourceMapInput(e));const a=null!=n.sections?new Te(n,t):new ve(n,t);return Promise.resolve(a)}(e,t)}static initialize(e){we.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,t){return function(e,t){return ve.fromSourceMap(e,t)}(e,t)}static async with(e,t,n){const a=await new Pe(e,t);try{return await n(a)}finally{a.destroy()}}_parseMappings(e,t){throw new Error("Subclasses must implement _parseMappings")}eachMapping(e,t,n){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}Pe.prototype._version=3,Pe.GENERATED_ORDER=1,Pe.ORIGINAL_ORDER=2,Pe.GREATEST_LOWER_BOUND=1,Pe.LEAST_UPPER_BOUND=2;var xe=Pe;class ve extends Pe{constructor(e,t){return super(Ee).then((n=>{let a=e;"string"==typeof e&&(a=fe.parseSourceMapInput(e));const r=fe.getArg(a,"version");let s=fe.getArg(a,"sources");const o=fe.getArg(a,"names",[]);let i=fe.getArg(a,"sourceRoot",null);const l=fe.getArg(a,"sourcesContent",null),u=fe.getArg(a,"mappings"),c=fe.getArg(a,"file",null);if(r!=n._version)throw new Error("Unsupported version: "+r);return i&&(i=fe.normalize(i)),s=s.map(String).map(fe.normalize).map((function(e){return i&&fe.isAbsolute(i)&&fe.isAbsolute(e)?fe.relative(i,e):e})),n._names=ke.fromArray(o.map(String),!0),n._sources=ke.fromArray(s,!0),n._absoluteSources=n._sources.toArray().map((function(e){return fe.computeSourceURL(i,e,t)})),n.sourceRoot=i,n.sourcesContent=l,n._mappings=u,n._sourceMapURL=t,n.file=c,n._computedColumnSpans=!1,n._mappingsPtr=0,n._wasm=null,Me().then((e=>(n._wasm=e,n)))}))}_findSourceIndex(e){let t=e;if(null!=this.sourceRoot&&(t=fe.relative(this.sourceRoot,t)),this._sources.has(t))return this._sources.indexOf(t);for(let n=0;n<this._absoluteSources.length;++n)if(this._absoluteSources[n]==e)return n;return-1}static fromSourceMap(e,t){return new ve(e.toString())}get sources(){return this._absoluteSources.slice()}_getMappingsPtr(){return 0===this._mappingsPtr&&this._parseMappings(this._mappings,this.sourceRoot),this._mappingsPtr}_parseMappings(e,t){const n=e.length,a=this._wasm.exports.allocate_mappings(n),r=new Uint8Array(this._wasm.exports.memory.buffer,a,n);for(let o=0;o<n;o++)r[o]=e.charCodeAt(o);const s=this._wasm.exports.parse_mappings(a);if(!s){const e=this._wasm.exports.get_last_error();let t=`Error parsing mappings (code ${e}): `;switch(e){case 1:t+="the mappings contained a negative line, column, source index, or name index";break;case 2:t+="the mappings contained a number larger than 2**32";break;case 3:t+="reached EOF while in the middle of parsing a VLQ";break;case 4:t+="invalid base 64 character while parsing a VLQ";break;default:t+="unknown error code"}throw new Error(t)}this._mappingsPtr=s}eachMapping(e,t,n){const a=t||null,r=n||Pe.GENERATED_ORDER,s=this.sourceRoot;this._wasm.withMappingCallback((t=>{null!==t.source&&(t.source=this._sources.at(t.source),t.source=fe.computeSourceURL(s,t.source,this._sourceMapURL),null!==t.name&&(t.name=this._names.at(t.name))),e.call(a,t)}),(()=>{switch(r){case Pe.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case Pe.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}}))}allGeneratedPositionsFor(e){let t=fe.getArg(e,"source");const n=fe.getArg(e,"line"),a=e.column||0;if(t=this._findSourceIndex(t),t<0)return[];if(n<1)throw new Error("Line numbers must be >= 1");if(a<0)throw new Error("Column numbers must be >= 0");const r=[];return this._wasm.withMappingCallback((e=>{let t=e.lastGeneratedColumn;this._computedColumnSpans&&null===t&&(t=1/0),r.push({line:e.generatedLine,column:e.generatedColumn,lastColumn:t})}),(()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),t,n-1,"column"in e,a)})),r}destroy(){0!==this._mappingsPtr&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(e){const t={generatedLine:fe.getArg(e,"line"),generatedColumn:fe.getArg(e,"column")};if(t.generatedLine<1)throw new Error("Line numbers must be >= 1");if(t.generatedColumn<0)throw new Error("Column numbers must be >= 0");let n,a=fe.getArg(e,"bias",Pe.GREATEST_LOWER_BOUND);if(null==a&&(a=Pe.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback((e=>n=e),(()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),t.generatedLine-1,t.generatedColumn,a)})),n&&n.generatedLine===t.generatedLine){let e=fe.getArg(n,"source",null);null!==e&&(e=this._sources.at(e),e=fe.computeSourceURL(this.sourceRoot,e,this._sourceMapURL));let t=fe.getArg(n,"name",null);return null!==t&&(t=this._names.at(t)),{source:e,line:fe.getArg(n,"originalLine",null),column:fe.getArg(n,"originalColumn",null),name:t}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return!!this.sourcesContent&&(this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e})))}sourceContentFor(e,t){if(!this.sourcesContent)return null;const n=this._findSourceIndex(e);if(n>=0)return this.sourcesContent[n];let a,r=e;if(null!=this.sourceRoot&&(r=fe.relative(this.sourceRoot,r)),null!=this.sourceRoot&&(a=fe.urlParse(this.sourceRoot))){const e=r.replace(/^file:\/\//,"");if("file"==a.scheme&&this._sources.has(e))return this.sourcesContent[this._sources.indexOf(e)];if((!a.path||"/"==a.path)&&this._sources.has("/"+r))return this.sourcesContent[this._sources.indexOf("/"+r)]}if(t)return null;throw new Error('"'+r+'" is not in the SourceMap.')}generatedPositionFor(e){let t=fe.getArg(e,"source");if(t=this._findSourceIndex(t),t<0)return{line:null,column:null,lastColumn:null};const n={source:t,originalLine:fe.getArg(e,"line"),originalColumn:fe.getArg(e,"column")};if(n.originalLine<1)throw new Error("Line numbers must be >= 1");if(n.originalColumn<0)throw new Error("Column numbers must be >= 0");let a,r=fe.getArg(e,"bias",Pe.GREATEST_LOWER_BOUND);if(null==r&&(r=Pe.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback((e=>a=e),(()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),n.source,n.originalLine-1,n.originalColumn,r)})),a&&a.source===n.source){let e=a.lastGeneratedColumn;return this._computedColumnSpans&&null===e&&(e=1/0),{line:fe.getArg(a,"generatedLine",null),column:fe.getArg(a,"generatedColumn",null),lastColumn:e}}return{line:null,column:null,lastColumn:null}}}ve.prototype.consumer=Pe;var Le=ve;class Te extends Pe{constructor(e,t){return super(Ee).then((n=>{let a=e;"string"==typeof e&&(a=fe.parseSourceMapInput(e));const r=fe.getArg(a,"version"),s=fe.getArg(a,"sections");if(r!=n._version)throw new Error("Unsupported version: "+r);n._sources=new ke,n._names=new ke,n.__generatedMappings=null,n.__originalMappings=null,n.__generatedMappingsUnsorted=null,n.__originalMappingsUnsorted=null;let o={line:-1,column:0};return Promise.all(s.map((e=>{if(e.url)throw new Error("Support for url field in sections not implemented.");const n=fe.getArg(e,"offset"),a=fe.getArg(n,"line"),r=fe.getArg(n,"column");if(a<o.line||a===o.line&&r<o.column)throw new Error("Section offsets must be ordered and non-overlapping.");o=n;return new Pe(fe.getArg(e,"map"),t).then((e=>({generatedOffset:{generatedLine:a+1,generatedColumn:r+1},consumer:e})))}))).then((e=>(n._sections=e,n)))}))}get _generatedMappings(){return this.__generatedMappings||this._sortGeneratedMappings(),this.__generatedMappings}get _originalMappings(){return this.__originalMappings||this._sortOriginalMappings(),this.__originalMappings}get _generatedMappingsUnsorted(){return this.__generatedMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappingsUnsorted}get _originalMappingsUnsorted(){return this.__originalMappingsUnsorted||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappingsUnsorted}_sortGeneratedMappings(){const e=this._generatedMappingsUnsorted;e.sort(fe.compareByGeneratedPositionsDeflated),this.__generatedMappings=e}_sortOriginalMappings(){const e=this._originalMappingsUnsorted;e.sort(fe.compareByOriginalPositions),this.__originalMappings=e}get sources(){const e=[];for(let t=0;t<this._sections.length;t++)for(let n=0;n<this._sections[t].consumer.sources.length;n++)e.push(this._sections[t].consumer.sources[n]);return e}originalPositionFor(e){const t={generatedLine:fe.getArg(e,"line"),generatedColumn:fe.getArg(e,"column")},n=Se.search(t,this._sections,(function(e,t){const n=e.generatedLine-t.generatedOffset.generatedLine;return n||e.generatedColumn-t.generatedOffset.generatedColumn})),a=this._sections[n];return a?a.consumer.originalPositionFor({line:t.generatedLine-(a.generatedOffset.generatedLine-1),column:t.generatedColumn-(a.generatedOffset.generatedLine===t.generatedLine?a.generatedOffset.generatedColumn-1:0),bias:e.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))}sourceContentFor(e,t){for(let n=0;n<this._sections.length;n++){const t=this._sections[n].consumer.sourceContentFor(e,!0);if(t)return t}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(e){for(let t=0;t<this._sections.length;t++){const n=this._sections[t];if(-1===n.consumer._findSourceIndex(fe.getArg(e,"source")))continue;const a=n.consumer.generatedPositionFor(e);if(a){return{line:a.line+(n.generatedOffset.generatedLine-1),column:a.column+(n.generatedOffset.generatedLine===a.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}}_parseMappings(e,t){const n=this.__generatedMappingsUnsorted=[],a=this.__originalMappingsUnsorted=[];for(let r=0;r<this._sections.length;r++){const e=this._sections[r],t=[];e.consumer.eachMapping((e=>t.push(e)));for(let r=0;r<t.length;r++){const s=t[r];let o=fe.computeSourceURL(e.consumer.sourceRoot,null,this._sourceMapURL);this._sources.add(o),o=this._sources.indexOf(o);let i=null;s.name&&(this._names.add(s.name),i=this._names.indexOf(s.name));const l={source:o,generatedLine:s.generatedLine+(e.generatedOffset.generatedLine-1),generatedColumn:s.generatedColumn+(e.generatedOffset.generatedLine===s.generatedLine?e.generatedOffset.generatedColumn-1:0),originalLine:s.originalLine,originalColumn:s.originalColumn,name:i};n.push(l),"number"==typeof l.originalLine&&a.push(l)}}}eachMapping(e,t,n){const a=t||null;let r;switch(n||Pe.GENERATED_ORDER){case Pe.GENERATED_ORDER:r=this._generatedMappings;break;case Pe.ORIGINAL_ORDER:r=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}const s=this.sourceRoot;r.map((function(e){let t=null;return null!==e.source&&(t=this._sources.at(e.source),t=fe.computeSourceURL(s,t,this._sourceMapURL)),{source:t,generatedLine:e.generatedLine,generatedColumn:e.generatedColumn,originalLine:e.originalLine,originalColumn:e.originalColumn,name:null===e.name?null:this._names.at(e.name)}}),this).forEach(e,a)}_findMapping(e,t,n,a,r,s){if(e[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+e[n]);if(e[a]<0)throw new TypeError("Column must be greater than or equal to 0, got "+e[a]);return Se.search(e,t,r,s)}allGeneratedPositionsFor(e){const t=fe.getArg(e,"line"),n={source:fe.getArg(e,"source"),originalLine:t,originalColumn:fe.getArg(e,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];if(n.originalLine<1)throw new Error("Line numbers must be >= 1");if(n.originalColumn<0)throw new Error("Column numbers must be >= 0");const a=[];let r=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",fe.compareByOriginalPositions,Se.LEAST_UPPER_BOUND);if(r>=0){let n=this._originalMappings[r];if(void 0===e.column){const e=n.originalLine;for(;n&&n.originalLine===e;){let e=n.lastGeneratedColumn;this._computedColumnSpans&&null===e&&(e=1/0),a.push({line:fe.getArg(n,"generatedLine",null),column:fe.getArg(n,"generatedColumn",null),lastColumn:e}),n=this._originalMappings[++r]}}else{const e=n.originalColumn;for(;n&&n.originalLine===t&&n.originalColumn==e;){let e=n.lastGeneratedColumn;this._computedColumnSpans&&null===e&&(e=1/0),a.push({line:fe.getArg(n,"generatedLine",null),column:fe.getArg(n,"generatedColumn",null),lastColumn:e}),n=this._originalMappings[++r]}}}return a}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}var Oe={SourceMapConsumer:xe,BasicSourceMapConsumer:Le,IndexedSourceMapConsumer:Te}.SourceMapConsumer;ne.platform(),Oe.initialize&&Oe.initialize({"lib/mappings.wasm":"https://unpkg.com/source-map@0.7.3/lib/mappings.wasm"});const Ae={};function De(e,t){const n=t.preset.parseStacktrace(e);let a=Promise.resolve();n.items.forEach(((e,r)=>{const s=(e,a)=>{const{line:r=0,column:o=0,file:i,fileName:l,fileRelative:u}=e;if(e.thirdParty)return Promise.resolve();try{return(c=i,p=l,d=u,t.preset.getSourceMapContent(c,p,d).then((e=>{if(e)return function(e){return new Promise(((t,n)=>{try{if(Oe.with)Oe.with(e,null,(e=>{t(e)}));else{const n=Oe(e);t(n)}}catch(a){n()}}))}(e).then((e=>function(e,t,n){const{source:a,line:r,column:s}=e.originalPositionFor(t);if(a){const t=a.split("/");return{source:a,sourcePath:t.slice(3).join("/"),sourceLine:null===r?0:r,sourceColumn:null===s?0:s,fileName:t.pop(),sourceContent:n&&e.sourceContentFor(a)||""}}}(e,{line:r,column:o},!!t.withSourceContent)))}))).then((t=>{if(t){const{source:o,sourcePath:i,sourceLine:l,sourceColumn:u,sourceContent:c,fileName:p=""}=t;n.items[a]=Object.assign({},e,{file:o,line:l,column:u,fileShort:i,fileRelative:o,fileName:p,thirdParty:(r=i,-1!==r.indexOf("@dcloudio")),parsed:!0,sourceContent:c});const d=n.items[a];if(n.isMP&&-1!==d.beforeParse.indexOf("app-service"))return s(d,a)}var r}))}catch(h){return Promise.resolve()}var c,p,d};a=a.then((()=>new Promise(((t,n)=>{setTimeout((()=>{s(e,r).then(t)}),0)}))))}));return new Promise(((r,s)=>{a.then((()=>{const a=t.preset.asTableStacktrace({stack:n,maxColumnWidths:{callee:999,file:999,sourceLine:999},stacktrace:e});r(a)})).catch((()=>{r(e)}))}))}function Re(e){if("string"==typeof e)return e;return`${e[0]}${e[1]?`  ${e[1]}`:""}${e[2]?` ${e[2]}`:""}`}function Ue(e){const{base:t,sourceRoot:n,splitThirdParty:a,uniPlatform:r}=e;let s;return{parseSourceMapUrl(e,a,r){if(-1!==r.indexOf("(")&&(r=r.match(/\((.*)/)[1]),!t||!r)return"";if(n)return`${r.replace(n,t+"/")}.map`;let o="";return s.isMP&&(-1!==r.indexOf("app-service.js")&&(o=(t.match(/\w$/)?"/":"")+"__WEIXIN__",r===a&&(o+="/__APP__"),r=r.replace(".js",".map")),o&&r.match(/^\w/)&&(o+="/")),`${t}${o}${r}.map`},getSourceMapContent(e,t,n){if(s.isMP&&-1===n.indexOf(".js"))return Promise.resolve("");const a=this.parseSourceMapUrl(e,t,n);return Promise.resolve(function(e){try{return Ae[e]||(Ae[e]=new Promise(((t,n)=>{try{/^[http|https]+:/i.test(e)?w({url:e,success:n=>{200===n.statusCode?(Ae[e]=n.data,t(Ae[e])):t(Ae[e]="")},fail(){t(Ae[e]="")}}):(Ae[e]=ne.readFileSync(e,"utf-8"),t(Ae[e]))}catch(a){t("")}})))}catch(t){return""}}(a))},parseStacktrace:e=>(s=new de(e,r),s),asTableStacktrace({maxColumnWidths:e,stacktrace:t,stack:n}){const r=t.split("\n")[0],s=n.asTable?n.asTable(e?{maxColumnWidths:e}:void 0):{items:[],thirdPartyItems:[]};if(s.items.length||s.thirdPartyItems.length){const{items:e,thirdPartyItems:t}=s,r=n.itemsHeader.map((t=>{if("%StacktraceyItem%"===t){const t=e.shift();return t?Re(t):""}return t})).filter(Boolean).join("\n"),o=t.length?t.map(Re).join("\n"):"";return a?{userError:r,thirdParty:o}:r+"\n"+o}return a?{userError:r,thirdParty:""}:r}}}const Fe=[{title:"错误总数",value:0,tooltip:"指应用在某个时间段内出现错误的总数"},{title:"错误率",value:0,tooltip:"时间范围内的总错误数/应用启动次数，如果小于0.01%，默认显示为0"}],$e=b.database(),Ie=$e.command,Ne="uni-stat-error-source-map",qe="__UNI__/uni-stat/sourcemap";var ze={};const Be=e({data:()=>({uniStat:C.uniStat,fieldsMap:Y,popupFieldsMap:Z,query:{dimension:"day",appid:"",platform_id:"",uni_platform:"",version_id:"",start_time:[]},uploadOptions:j({appid:"",uni_platform:""}),uploadMsg:"",options:{pageSize:20,pageCurrent:1,total:0},loading:!1,popupLoading:!1,currentDateTab:0,tableData:[],popupTableData:[],panelData:JSON.parse(JSON.stringify(Fe)),chartData:{},chartTab:"errorCount",chartTabs:[{_id:"errorCount",name:"错误次数"},{_id:"errorRate",name:"错误率"}],errMsg:"",msgLoading:!1,uploadFile:{tempFileTasks:[],tempFiles:[],clear(){this.tempFileTasks.length=this.tempFiles.length=0}},uploadSuccessTaskNames:[],errorItem:"",errorMessage:""}),components:{uploadTask:te},computed:{queryStr(){return G(this.query)},versionQuery(){const{appid:e,uni_platform:t}=this.query;return G(j({appid:e,uni_platform:t}))},uploadVersionQuery(){const{appid:e,uni_platform:t}=this.uploadOptions;return G(j({appid:e,uni_platform:t}))},vaildate(){const e=Object.keys(this.uploadOptions).every((e=>this.uploadOptions[e]));return e&&this.uploadMsg&&(this.uploadMsg=""),e},uploadSuccessTasks(){return this.uploadFile.tempFileTasks.filter((e=>1===e.state))},sortUploadFileTempFileTasks(){return this.uploadFile.tempFileTasks.filter((e=>1!==e.state)).sort(((e,t)=>e.state-t.state))},sourceMapEnabled:()=>!0,channelQuery(){const e=this.query.platform_id;return G({platform_id:e})}},created(){if(this.parsedErrors={},this.sourceMapEnabled)if(this.uniStat.uploadSourceMapCloudSpaceId)if("aliyun"===this.uniStat.uploadSourceMapCloudPlatform){let e=0===this.uniStat.uploadSourceMapCloudSpaceId.indexOf("mp-")?"https://api.next.bspapp.com":"https://api.bspapp.com";this.uploadSourcemapCloud=b.init({provider:"aliyun",spaceId:this.uniStat.uploadSourceMapCloudSpaceId,clientSecret:this.uniStat.uploadSourceMapCloudClientSecret,endpoint:e})}else this.uploadSourcemapCloud=b.init({provider:"tencent",spaceId:this.uniStat.uploadSourceMapCloudSpaceId});else this.uploadSourcemapCloud=b;this.getCloudDataDebounce=V((()=>{this.getAllData(this.queryStr)}),300),this.getCloudDataDebounce()},watch:{query:{deep:!0,handler(e,t){this.options.pageCurrent=1,this.getCloudDataDebounce()}},chartTab(e){this.getChartData(this.queryStr)}},methods:{useDatetimePicker(e){this.currentDateTab=-1},changePlatform(e,t,n,a){this.query.version_id=0,this.uploadOptions.uni_platform=a.code,this.query.uni_platform=a.code},changeTimeRange(e,t){this.currentDateTab=t;const n=W(e),a=W(0)-1;this.query.start_time=[n,a]},changePageCurrent(e){this.options.pageCurrent=e.current,this.getTableData(this.queryStr)},changePageSize(e){this.options.pageSize=e,this.options.pageCurrent=1,this.getTableData(this.queryStr)},getAllData(e){-1!==e.indexOf("appid")?(this.errorMessage="",this.getChartData(e),this.getTableData(e)):this.errorMessage="请先选择应用"},getChartData(e,t="day_count"){let n=G(this.query,!1,["uni_platform"]);this.chartData={},this.options;const a=b.database(),[r,s]=this.query.start_time,o=Q(new Date(r),new Date(s));a.collection("uni-stat-error-result").where(n).groupBy("start_time").groupField("sum(count) as total_day_count").orderBy("start_time","desc").get({getCount:!0}).then((async e=>{e.result.count;const a=e.result.data;let r=[];o.forEach((e=>{let t=a.find((t=>t.start_time===e));t?r.push(t):r.push({start_time:e,total_day_count:0})}));const s={categories:[],series:[{name:"暂无数据",data:[]}]};if("errorCount"===this.chartTab){const e=s.series[0]={name:"错误次数",data:[]},n=s.categories;for(const a of r){let r=a.start_time;const s=H(r,"day"),o=a[`total_${t}`];n.push(s),e.data.push(o)}this.chartData=s}else{let e=await this.getDayLaunch(n);const a=s.series[0]={name:"错误率(%)",data:[],lineStyle:{color:"#EE6666",width:1},itemStyle:{borderWidth:1,borderColor:"#EE6666",color:"#EE6666"},areaStyle:{color:{colorStops:[{offset:0,color:"#EE6666"},{offset:1,color:"#FFFFFF"}]}}},o=s.categories;for(const n of r){let r=n.start_time;const s=H(r,"day"),i=n[`total_${t}`];if(o.push(s),e.length){const t=e.find((e=>e.start_time===n.start_time)),r=o.indexOf(s);if(t){let e=100*i/t.day_app_launch_count;e=e.toFixed(2),a.data[r]=e}else a.data[r]=0}}this.chartData=s}})).catch((e=>{console.error(e)})).finally((()=>{}))},getTotalCount:e=>b.database().collection("uni-stat-error-result").where(e).groupBy("appid").groupField("sum(count) as total_count").get(),getTotalLaunch:e=>b.database().collection("uni-stat-result").where(e).groupBy("appid").groupField("sum(app_launch_count) as total_app_launch_count").get(),async getDayLaunch(e){const t=b.database();return(await t.collection("uni-stat-result").where(e).groupBy("start_time").groupField("sum(app_launch_count) as day_app_launch_count").orderBy("start_time","asc").get()).result.data||[]},getTableData(e=G(this.query)){let t=G(this.query,!1,["uni_platform"]);const{pageCurrent:n}=this.options;this.loading=!0;const a=b.database(),r=G(j({appid:this.query.appid})),s=a.collection("uni-stat-error-result").where(t).getTemp(),o=a.collection("opendb-app-versions").where(r).getTemp(),i=a.collection("uni-stat-app-platforms").getTemp();a.collection(s,o,i).orderBy("count","desc").skip((n-1)*this.options.pageSize).limit(this.options.pageSize).get({getCount:!0}).then((e=>{const{count:n,data:a}=e.result,r=[];this.panelData=JSON.parse(JSON.stringify(Fe));for(const t of a){t.last_time=J(t.last_time,"dateTime"),t.msgTooltip=t.msg,t.msg=t.msg?t.msg.substring(0,100)+"...":"";const e=t.version_id[0],n=t.platform_id[0];t.version=e&&e.version,t.platform=n&&n.name,t.platform_code=n&&n.code,r.push(t)}this.getTotalCount(t).then((e=>{const n=e.result.data[0],a=n&&n.total_count;a&&(r.forEach((e=>e.total_count=Number(a))),this.panelData[0].value=a);let s="";this.getTotalLaunch(t).then((e=>{const t=e.result.data[0];if(s=t&&t.total_app_launch_count,a&&s){let e=a/s;e=(100*e).toFixed(2)+"%",this.panelData[1].value=e}}))})).finally((()=>{this.tableData=[],this.options.total=n,r.forEach((e=>X(Y,e,e))),this.tableData=r}))})).catch((e=>{console.error(e)})).finally((()=>{this.loading=!1}))},navTo(e,t){e.indexOf("http")>-1?window.open(e):(t&&(e=`${e}?error_hash=${t.hash}&create_time=${t.start_time}`),S({url:e}))},closeErrPopup(){this.$refs.errMsg.close()},errMsgPopupChange(e){if(e.show){const e=this.errorItem.msgTooltip;return this.msgLoading?void this.closeErrPopup():(e||(this.errMsg="暂无错误数据"),this.errMsg="",this.parsedErrors[e],this.msgLoading=!0,void this.parseError(this.errorItem))}this.msgLoading=!1},async parseError(e){let t,{msgTooltip:n,appid:a,platform_code:r,version:s}=e,o=`/${a}/${r}/${s}/`;ze[o]&&ze[o].length>0?t=ze[o]:(t=await this.getSourceMapFileList({base:o}),t&&t.length>0?ze[o]=t:console.error(`缺少${o}对应的sourceMap，请先上传sourceMap`));try{n=JSON.parse(n)}catch(l){}const i={base:o,uniPlatform:r,splitThirdParty:!0};["ios","android","app"].indexOf(r)>-1&&(i.lineOffset=-1),De(n,{preset:{...Ue(i),parseSourceMapUrl(e,n,a){if(-1!==a.indexOf("(")){let e=a.match(/\((.*)/);a=e&&e[1]}if(!o||!a)return"";if("undefined"!=typeof sourceRoot)return`${a.replace(sourceRoot,o+"/")}.map`;let s="";r.indexOf("mp-")>-1&&-1!==a.indexOf("app-service.js")&&(s=(o.match(/\w$/)?"/":"")+"__WEIXIN__",a===n&&(s+="/__APP__")),s&&a.match(/^\w/)&&(s+="/");let i,l=`${qe}${`${o}${s}${a}.map`}`;if("web"===r){let e=a.substring(a.indexOf("/")+1);i=`${qe}${`${o}${s}${e}.map`}`}let u=t.find((e=>[l,i].indexOf(e.cloud_path)>-1));return u?u.url:l}}}).then((e=>{const{userError:t,thirdParty:a}=e,s=t.length&&a.length?`\n\n------------${-1!==r.indexOf("mp-")?r:"uni-app"} runtime error------------\n\n`:"";this.errMsg=`${t}${s}${a}`,this.parsedErrors[n]=this.errMsg})).finally((()=>{this.msgLoading=!1}))},openUploadPopup(){const{appid:e,uni_platform:t}=this.query;this.uploadOptions={appid:e,uni_platform:t},this.$refs.upload.open()},closeUploadPopup(){this.$refs.upload.close()},createUploadFileTask(e,t,n,a){const r=e+t;return this.uploadSourcemapCloud.uploadFile({filePath:n,cloudPath:r,onUploadProgress:a})},async choosefile(){if(!this.vaildate)return void(this.uploadMsg="请先将应用、平台、版本填写完整");const{appid:e,uni_platform:t,version:n}=this.uploadOptions,a=`/${e}/${t}/${n}/`,r=`${qe}${a}`,s=document.createElement("input");s.type="file",s.directory=!0,s.webkitdirectory=!0,s.click(),s.addEventListener("change",(async()=>{this.uploadFile.clear();const o=s.files;if(!o.length)return;Array.prototype.forEach.call(o,(e=>{const t=K(e);this.uploadFile.tempFileTasks.push({fileDiskPath:e.webkitRelativePath.split("/").slice(1).join("/"),path:t,size:`${(e.size/1024).toFixed(2)}kb`,name:e.name,state:0,progress:0,file:e}),Object.defineProperty(e,"path",{get:()=>t}),this.uploadFile.tempFiles.push(e)}));let i=[];for(let s=0;s<this.uploadFile.tempFileTasks.length;s++){let o=this.uploadFile.tempFileTasks[s],l=await new Promise(((s,i)=>{-1!==this.uploadSuccessTaskNames.indexOf(o.name)?(o.progress=1,setTimeout((()=>{o.state=1,s()}),200)):this.createUploadFileTask(r,o.fileDiskPath,o.path,(e=>{const{loaded:t,total:n}=e;o.progress=t/n})).then((i=>{const l=r+o.fileDiskPath;let u=i.fileID;b.getTempFileURL({fileList:[u]}).then((r=>{let i=r.fileList[0].tempFileURL,c={appid:e,uni_platform:t,version:n,file_id:u,url:i,name:o.name,size:o.file.size,cloud_path:l,base:a};setTimeout((()=>{this.uploadSuccessTaskNames.push(name),o.state=1,s(c)}),100)}))})).catch((e=>{o.state=-1,i(`${o.name} 上传失败：`+JSON.stringify(e))}))}));l&&i.push(l)}i&&i.length>0&&await this.addSourceMapFile(i)}))},createStr(e,t,n="total_"){const a=[];return e.forEach((e=>{if(field.hasOwnProperty("value")){const r=e.field;a.push(`${t}(${r}) as ${n+r}`)}})),a.join()},openErrPopup(e){this.errorItem=e,this.$refs.errMsg.open()},async addSourceMapFile(e){let t=[];e.map(((e,n)=>{t.push(e.cloud_path)})),await $e.collection(Ne).where({cloud_path:Ie.in(t)}).remove(),await $e.collection(Ne).add(e)},async getSourceMapFileList(e){let{base:t}=e;return(await $e.collection(Ne).where({base:t}).limit(1e3).get()).result.data||[]}}},[["render",function(e,i,l,u,y,w){const b=M(k("uni-stat-breadcrumb"),U),C=p,S=M(k("uni-data-select"),F),j=M(k("uni-stat-tabs"),$),G=M(k("uni-datetime-picker"),v),V=M(k("uni-stat-panel"),I),W=M(k("qiun-data-charts"),N),Q=E,H=M(k("uni-icons"),L),J=M(k("uni-tooltip"),q),X=M(k("uni-th"),T),K=M(k("uni-tr"),O),Y=_,Z=M(k("uni-td"),A),te=M(k("uni-table"),D),ne=M(k("uni-pagination"),z),ae=M(k("uni-load-more"),B),re=P,se=M(k("uni-popup"),R),oe=t("uploadTask"),ie=M(k("uni-drawer"),ee);return n(),a(C,{class:"fix-top-window"},{default:r((()=>[s(C,{class:"uni-header"},{default:r((()=>[s(b,{class:"uni-stat-breadcrumb-on-phone"}),s(C,{class:"uni-group hide-on-phone"},{default:r((()=>[s(C,{class:"uni-sub-title"},{default:r((()=>[g("开发者可以在这里快速查询应用最近出现的具体错误内容，了解错误概况信息，以便快速修复问题")])),_:1})])),_:1})])),_:1}),s(C,{class:"uni-container"},{default:r((()=>[s(C,{class:"uni-stat--x flex p-1015"},{default:r((()=>[s(S,{collection:"opendb-app-list",field:"appid as value, name as text",orderby:"text asc",defItem:1,label:"应用选择",modelValue:y.query.appid,"onUpdate:modelValue":i[0]||(i[0]=e=>y.query.appid=e),clear:!1},null,8,["modelValue"]),s(S,{collection:"opendb-app-versions",where:w.versionQuery,class:"ml-m",field:"_id as value, version as text, uni_platform as label, create_date as date",format:"{label} - {text}",orderby:"date desc",label:"版本选择",modelValue:y.query.version_id,"onUpdate:modelValue":i[1]||(i[1]=e=>y.query.version_id=e)},null,8,["where","modelValue"])])),_:1}),s(C,{class:"uni-stat--x flex"},{default:r((()=>[s(j,{label:"日期选择",current:y.currentDateTab,yesterday:!1,mode:"date",onChange:w.changeTimeRange},null,8,["current","onChange"]),s(G,{type:"daterange",end:(new Date).getTime(),modelValue:y.query.start_time,"onUpdate:modelValue":i[2]||(i[2]=e=>y.query.start_time=e),returnType:"timestamp",clearIcon:!1,class:o(["uni-stat-datetime-picker",{"uni-stat__actived":y.currentDateTab<0&&!!y.query.start_time.length}]),onChange:w.useDatetimePicker},null,8,["end","modelValue","class","onChange"])])),_:1}),s(C,{class:"uni-stat--x"},{default:r((()=>[s(j,{label:"平台选择",type:"boldLine",mode:"platform",modelValue:y.query.platform_id,"onUpdate:modelValue":i[3]||(i[3]=e=>y.query.platform_id=e),onChange:w.changePlatform},null,8,["modelValue","onChange"]),y.query.platform_id&&-1===y.query.platform_id.indexOf("==")?(n(),a(S,{key:0,ref:"version-select",collection:"uni-stat-app-channels",where:w.channelQuery,class:"p-channel",field:"_id as value, channel_name as text",orderby:"text asc",label:"渠道/场景值选择",modelValue:y.query.channel_id,"onUpdate:modelValue":i[4]||(i[4]=e=>y.query.channel_id=e)},null,8,["where","modelValue"])):c("",!0)])),_:1}),s(C,{class:"uni-stat--x",style:{padding:"15px 0"}},{default:r((()=>[s(V,{items:y.panelData,class:"uni-stat-panel"},null,8,["items"]),s(j,{type:"box",modelValue:y.chartTab,"onUpdate:modelValue":i[5]||(i[5]=e=>y.chartTab=e),tabs:y.chartTabs,class:"mb-l"},null,8,["modelValue","tabs"]),s(C,{class:"uni-charts-box"},{default:r((()=>[s(W,{type:"area",chartData:y.chartData,eopts:{notMerge:!0},echartsH5:"",echartsApp:"",tooltipFormat:"tooltipCustom",errorMessage:y.errorMessage},null,8,["chartData","errorMessage"])])),_:1})])),_:1}),s(C,{class:"uni-stat--x p-m"},{default:r((()=>[s(C,{class:"flex-between"},{default:r((()=>[s(C,{class:"uni-stat-card-header"},{default:r((()=>[g("信息列表")])),_:1}),s(C,{class:"uni-group"},{default:r((()=>[w.sourceMapEnabled?(n(),a(Q,{key:0,class:"uni-button",type:"primary",size:"mini",onClick:w.openUploadPopup},{default:r((()=>[g("上传 sourceMap")])),_:1},8,["onClick"])):c("",!0)])),_:1})])),_:1}),s(te,{loading:y.loading,border:"",stripe:"",emptyText:e.$t("common.empty")},{default:r((()=>[s(K,null,{default:r((()=>[(n(!0),d(m,null,h(y.fieldsMap,((e,t)=>(n(),d(m,{key:t},[e.title?(n(),a(X,{key:t,align:"center"},{default:r((()=>[s(J,null,x({default:r((()=>[g(f(e.title)+" ",1),e.tooltip?(n(),a(H,{key:0,type:"help",color:"#666"})):c("",!0)])),_:2},[e.tooltip?{name:"content",fn:r((()=>[s(C,{class:"uni-stat-tooltip-s"},{default:r((()=>[g(f(e.tooltip),1)])),_:2},1024)])),key:"0"}:void 0]),1024)])),_:2},1024)):c("",!0)],64)))),128)),w.sourceMapEnabled?(n(),a(X,{key:0,align:"center"},{default:r((()=>[g(" 操作 ")])),_:1})):c("",!0)])),_:1}),(n(!0),d(m,null,h(y.tableData,((e,t)=>(n(),a(K,{key:t},{default:r((()=>[(n(!0),d(m,null,h(y.fieldsMap,((t,o)=>(n(),d(m,{key:o},["count"===t.field?(n(),a(Z,{key:t.field,align:"center"},{default:r((()=>[s(Y,{class:"link-btn",onClick:t=>w.navTo("detail",e)},{default:r((()=>[g(f(void 0!==e[t.field]?e[t.field]:"-"),1)])),_:2},1032,["onClick"])])),_:2},1024)):(n(),a(Z,{key:t.field,align:"center"},{default:r((()=>[g(f(void 0!==e[t.field]?e[t.field]:"-"),1)])),_:2},1024))],64)))),128)),w.sourceMapEnabled?(n(),a(Z,{key:0},{default:r((()=>[s(Q,{size:"mini",type:"primary",style:{"white-space":"nowrap"},onClick:t=>w.openErrPopup(e)},{default:r((()=>[g("详 情")])),_:2},1032,["onClick"])])),_:2},1024)):c("",!0)])),_:2},1024)))),128))])),_:1},8,["loading","emptyText"]),s(C,{class:"uni-pagination-box"},{default:r((()=>[s(ne,{"show-icon":"","show-page-size":"","page-size":y.options.pageSize,current:y.options.pageCurrent,total:y.options.total,onChange:w.changePageCurrent,onPageSizeChange:w.changePageSize},null,8,["page-size","current","total","onChange","onPageSizeChange"])])),_:1})])),_:1})])),_:1}),s(se,{ref:"errMsg",type:"center",animation:!1,maskClick:!0,onChange:w.errMsgPopupChange},{default:r((()=>[s(C,{class:"modal black-theme"},{default:r((()=>[s(C,{class:"modal-header"},{default:r((()=>[g(" 错误详情 ")])),_:1}),s(re,{"scroll-x":"true","scroll-y":"true"},{default:r((()=>[s(C,{class:"modal-content",style:{padding:"20px 30px"}},{default:r((()=>[y.msgLoading?(n(),a(C,{key:0,style:{margin:"150px 0","text-align":"center","font-size":"14px"}},{default:r((()=>[s(ae,{class:"mb-m",showText:!1,status:"loading"}),s(C,null,{default:r((()=>[g("正在解析，请稍等...")])),_:1})])),_:1})):c("",!0),s(Y,null,{default:r((()=>[g(f(y.errMsg),1)])),_:1})])),_:1})])),_:1}),s(C,{class:"dialog-close",onClick:w.closeErrPopup},{default:r((()=>[s(C,{class:"dialog-close-plus","data-id":"close"}),s(C,{class:"dialog-close-plus dialog-close-rotate","data-id":"close"})])),_:1},8,["onClick"])])),_:1})])),_:1},8,["onChange"]),s(ie,{class:"sourcemap-drawser",ref:"upload",mode:"right","mask-click":!0,width:340},{default:r((()=>[s(C,{class:"modal",style:{"max-width":"none","min-width":"auto",padding:"0 10px"}},{default:r((()=>[s(C,{class:"modal-header"},{default:r((()=>[g(" 上传 sourceMap ")])),_:1}),s(C,{class:"modal-content",style:{height:"300px",padding:"0"}},{default:r((()=>[s(C,{style:{"margin-top":"10px"}},{default:r((()=>[s(S,{collection:"opendb-app-list",field:"appid as value, name as text",orderby:"text asc",label:"应用",modelValue:y.uploadOptions.appid,"onUpdate:modelValue":i[6]||(i[6]=e=>y.uploadOptions.appid=e)},null,8,["modelValue"])])),_:1}),s(C,{style:{"margin-top":"10px"}},{default:r((()=>[s(S,{collection:"uni-stat-app-platforms",field:"code as value, name as text",orderby:"text asc",label:"平台",modelValue:y.uploadOptions.uni_platform,"onUpdate:modelValue":i[7]||(i[7]=e=>y.uploadOptions.uni_platform=e)},null,8,["modelValue"])])),_:1}),s(C,{style:{"margin-top":"10px"}},{default:r((()=>[s(S,{collection:"opendb-app-versions",where:w.uploadVersionQuery,field:"version as value, version as text",orderby:"text desc",label:"版本",modelValue:y.uploadOptions.version,"onUpdate:modelValue":i[8]||(i[8]=e=>y.uploadOptions.version=e)},null,8,["where","modelValue"])])),_:1}),s(C,{class:"flex m-m"},{default:r((()=>[s(C,{class:"label-text"},{default:r((()=>[g("选择文件:")])),_:1}),s(Q,{class:"uni-button ml-m",type:"primary",onClick:w.choosefile},{default:r((()=>[g("选择文件并上传")])),_:1},8,["onClick"])])),_:1}),w.vaildate?c("",!0):(n(),a(C,{key:0,class:"upload-msg-warning"},{default:r((()=>[g(f(y.uploadMsg),1)])),_:1}))])),_:1}),s(C,{class:"dialog-close",onClick:w.closeUploadPopup},{default:r((()=>[s(C,{class:"dialog-close-plus",style:{"background-color":"#333"},"data-id":"close"}),s(C,{class:"dialog-close-plus dialog-close-rotate",style:{"background-color":"#333"},"data-id":"close"})])),_:1},8,["onClick"])])),_:1}),s(C,{class:"upload-task-header"},{default:r((()=>[s(Y,null,{default:r((()=>[g("上传任务："+f(w.uploadSuccessTasks.length)+"/"+f(y.uploadFile.tempFileTasks.length),1)])),_:1})])),_:1}),y.uploadFile.tempFileTasks.length?(n(),a(re,{key:0,style:{height:"calc(100vh - 362px)"},"scroll-y":"true"},{default:r((()=>[y.uploadFile.tempFileTasks.length>w.uploadSuccessTasks.length?(n(),a(C,{key:0},{default:r((()=>[s(C,{class:"upload-task-header"},{default:r((()=>[s(Y,null,{default:r((()=>[g("正在上传")])),_:1})])),_:1}),s(oe,{uploadTasks:w.sortUploadFileTempFileTasks},null,8,["uploadTasks"])])),_:1})):c("",!0),w.uploadSuccessTasks.length?(n(),a(C,{key:1},{default:r((()=>[s(C,{class:"upload-task-header"},{default:r((()=>[s(Y,{style:{color:"#42b983"}},{default:r((()=>[g("上传成功")])),_:1})])),_:1}),s(oe,{uploadTasks:w.uploadSuccessTasks,showProgress:!1},null,8,["uploadTasks"])])),_:1})):c("",!0)])),_:1})):c("",!0)])),_:1},512)])),_:1})}],["__scopeId","data-v-a0b830e1"]]);export{Be as default};
